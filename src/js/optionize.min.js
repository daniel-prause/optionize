!function(e){var t=null,a={searchBox:{enabled:!1,placeholder:"Search"},noEntriesText:"no entries"},i={};function n(t,a){var i=a.selected?"selected":"",n=a.disabled?"disabled":"",d=a.hidden||!1,o=e("<li>",{"data-text":a.innerHTML,"data-value":a.value,"data-disabled":a.disabled,"data-selected":a.selected,"data-hidden":d,"data-no-entries-element":a.noEntriesElement||!1}).addClass(i).addClass(n).addClass("option");a.hidden&&o.css("display","none");var s=a.dataset.afterText||"",l=a.dataset.beforeText||"";o.html(`${l}${a.innerHTML}${s}`),t.append(o)}function d(t,a,d,o){var s="disabled"==t.closest("fieldset").attr("disabled");e.each(d,function(t,i){if(s&&(i.disabled=!0),"OPTGROUP"==i.tagName){var d,o,l,r,c;d=a,l=(o=i).dataset.afterText||"",r=o.dataset.beforeText||"",(c=e("<li>").addClass("optgroup")).html(`${r}${o.label}${l}`),c.attr("data-hidden","false"),d.append(c)}else n(a,i)}),n(a,{innerHTML:i[o].noEntriesText,disabled:!0,selected:!1,hidden:d.length>0,value:"-",dataset:{},noEntriesElement:!0})}function o(e,t){"OPTGROUP"!=t.tagName&&(e.addClass("selected"),e.attr("data-selected","true"),t.selected=!0)}function s(e,t){"OPTGROUP"!=t.tagName&&(e.removeClass("selected"),e.attr("data-selected","false"),t.selected=!1)}function l(t,a){e(a).val().length>0?t.find(".optgroup").attr("data-hidden","true").hide():t.find(".optgroup").attr("data-hidden","false").show();var i=!1;t.find("li").each(function(t,n){(regex=RegExp(e(a).val(),"i")).test(e(n).text())&&"false"==e(n).attr("data-hidden")?(i=!0,e(n).show()):e(n).hide(),i||"true"!=e(n).attr("data-no-entries-element")||e(n).show()})}e.fn.optionize=function(n){return e(this).each(function(r,c){if("multiple"!==e(c).attr("multiple")){console.log("sorry, currently optionize only works on multi select boxes.");return}var p=e(c).attr("id")||e(c).attr("name");if(p||(p=`id-${e("select").index(e(c))}`,e(c).attr("id",p)),!(e(`.optionize-${p}`).length>0)){n&&"object"==typeof n&&(i[p]={},e.extend(!0,i[p],a,n));var h,f,u,b,g=e(c).find("optgroup, option"),v=e("<ul>").addClass(`optionize optionize-${p}`);d(e(c),v,g,p),e(c).hide(),e(c).before(v),function a(i,n){n.on("click","li:not(.optgroup)",function(a){var d=n.find("li");if(a.shiftKey){var l=e(this).index();null==t&&(t=e(this));var r=t.index();if(l>r){var c=l;l=r,r=c}var p=i.find("optgroup, option");e.each(d,function(t){t>=l&&t<=r&&!p[t].disabled?o(e(this),p[t]):s(e(this),p[t])})}else if(t=e(this),"true"!=e(this).attr("data-disabled")){e(this).attr("data-value");var h=i.find("optgroup, option").get(e(this).index());"true"==e(this).attr("data-selected")?s(e(this),h):o(e(this),h)}i.change()})}(e(c),v),function t(a,n,o){a.on("change DOMSubtreeModified click",function(){n.find("li").remove();var t=a.find("optgroup, option");d(a,n,t,o),i[o].searchBox.enabled&&l(n,e(`#optionize-searchbox-${o}`))})}(e(c),v,p),function t(a,i){i.on("click",".optgroup",function(){var t=i.find(".optgroup").index(e(this)),n=a.find(`optgroup:eq('${t}')`),d=n.find("option:enabled"),o=n.find("option:selected");d.length==o.length?d.prop("selected",!1):d.prop("selected",!0),a.change()})}(e(c),v),i[p].searchBox.enabled&&(h=v,f=`optionize-searchbox-${p}`,u=p,b=e("<input>",{type:"text",id:f,class:"optionize-search-box",placeholder:i[u].searchBox.placeholder}),b.on("keyup",function(){l(h,b)}),h.before(b))}}),e(this)}}(jQuery);
