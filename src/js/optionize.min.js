!function(e){var t=null,a={searchBox:{enabled:!1,placeholder:"Search"},noEntriesText:"no entries"},n={};function i(t,a){var n=a.selected?"selected":"",i=a.disabled?"disabled":"",d=a.hidden||!1,o=e("<li>",{"data-text":a.innerHTML,"data-value":a.value,"data-disabled":a.disabled,"data-selected":a.selected,"data-hidden":d,"data-no-entries-element":a.noEntriesElement||!1}).addClass(n).addClass(i).addClass("option");a.hidden&&o.css("display","none");var s=a.dataset.afterText||"",l=a.dataset.beforeText||"";o.html(`${l}${a.innerHTML}${s}`),t.append(o)}function d(t,a,d,o){var s="disabled"==t.closest("fieldset").attr("disabled");e.each(d,function(t,n){if(s&&(n.disabled=!0),"OPTGROUP"==n.tagName){var d,o,l,r,c;d=a,l=(o=n).dataset.afterText||"",r=o.dataset.beforeText||"",(c=e("<li>").addClass("optgroup")).html(`${r}${o.label}${l}`),c.attr("data-hidden","false"),d.append(c)}else i(a,n)}),i(a,{innerHTML:n[o].noEntriesText,disabled:!0,selected:!1,hidden:d.length>0,value:"-",dataset:{},noEntriesElement:!0})}function o(e,t){"OPTGROUP"!=t.tagName&&(e.addClass("selected"),e.attr("data-selected","true"),t.selected=!0)}function s(e,t){"OPTGROUP"!=t.tagName&&(e.removeClass("selected"),e.attr("data-selected","false"),t.selected=!1)}function l(t,a){e(a).val().length>0?t.find(".optgroup").attr("data-hidden","true").hide():t.find(".optgroup").attr("data-hidden","false").show();var n=!1;t.find("li").each(function(t,i){(regex=RegExp(e(a).val(),"i")).test(e(i).text())&&"false"==e(i).attr("data-hidden")?(n=!0,e(i).show()):e(i).hide(),n||"true"!=e(i).attr("data-no-entries-element")||e(i).show()})}e.fn.optionize=function(i){return e(this).each(function(r,c){if("multiple"!==e(c).attr("multiple")){console.log("sorry, currently optionize only works on multi select boxes.");return}var h=e(c).attr("id")||e(c).attr("name");if(h||(h=`id-${e("select").index(e(c))}`,e(c).attr("id",h)),!(e(`.optionize-${h}`).length>0)){i&&"object"==typeof i&&(n[h]={},e.extend(!0,n[h],a,i));var p,f,u,b,v=e(c).find("optgroup, option"),g=e("<ul>").addClass(`optionize optionize-${h}`);d(e(c),g,v,h),e(c).hide(),e(c).before(g),function a(n,i){i.on("click","li:not(.optgroup)",function(a){var d=i.find("li");if(a.shiftKey){var l=e(this).index();null==t&&(t=e(this));var r=t.index();if(l>r){var c=l;l=r,r=c}var h=n.find("optgroup, option");e.each(d,function(t){t>=l&&t<=r&&!h[t].disabled?o(e(this),h[t]):s(e(this),h[t])})}else if(t=e(this),"true"!=e(this).attr("data-disabled")){e(this).attr("data-value");var p=n.find("optgroup, option").get(e(this).index());"true"==e(this).attr("data-selected")?s(e(this),p):o(e(this),p)}n.change()})}(e(c),g),function t(a,i,o){let s=function(t,a,i){a.find("li").remove();var o=t.find("optgroup, option");d(t,a,o,i),n[i].searchBox.enabled&&l(a,e(`#optionize-searchbox-${i}`))};a.on("change click",function(){s(a,i,o)});let r=a[0],c=(e,t)=>{for(let n of e)s(a,i,o)},h=new MutationObserver(c);h.observe(r,{attributes:!0,childList:!0,subtree:!0})}(e(c),g,h),function t(a,n){n.on("click",".optgroup",function(){var t=n.find(".optgroup").index(e(this)),i=a.find(`optgroup:eq('${t}')`),d=i.find("option:enabled"),o=i.find("option:selected");d.length==o.length?d.prop("selected",!1):d.prop("selected",!0),a.change()})}(e(c),g),n[h].searchBox.enabled&&(p=g,f=`optionize-searchbox-${h}`,u=h,b=e("<input>",{type:"text",id:f,class:"optionize-search-box",placeholder:n[u].searchBox.placeholder}),b.on("keyup",function(){l(p,b)}),p.before(b))}}),e(this)}}(jQuery);
